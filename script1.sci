// Решение ОДУ методом Адамса-Мултона 1-го порядка в Scilab

// Определение функции правой части ОДУ dX/dt = f(X, t)
function dxdt = f(t, x)
    dxdt = -x + sin(t); // Пример уравнения, замените на свое
endfunction

// Метод Адамса-Мултона первого порядка (неявный метод)
function [T, X] = adams_moulton1(f, t0, t_end, x0, h)
    // Количество шагов
    N = int((t_end - t0) / h);
    
    // Создание массивов для хранения значений
    T = linspace(t0, t_end, N + 1);
    X = zeros(1, N + 1);
    X(1) = x0;
    
    // Итерационный метод (неявная схема)
    for n = 1:N
        t_n = T(n);
        x_n = X(n);
        
        // Итерационное уточнение X(n+1) (неявность метода)
        x_next = x_n + h * f(t_n, x_n); // Начальное приближение
        for k = 1:5 // 5 итераций уточнения
            x_next = x_n + h * f(T(n+1), x_next);
        end
        
        X(n+1) = x_next;
    end
endfunction

// Входные параметры
t0 = input("Введите начальное значение времени t0: ");
t_end = input("Введите конечное значение времени t_end: ");
x0 = input("Введите начальное значение X(0): ");
h = input("Введите шаг h: ");

// Запуск метода
[T, X] = adams_moulton1(f, t0, t_end, x0, h);

// Построение графика
plot(T, X, "b-");
xlabel("t");
ylabel("X(t)");
title("Решение ОДУ методом Адамса-Мултона 1-го порядка");
xgrid();
