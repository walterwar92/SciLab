// solver.sci — Решение ОДУ методом Адамса-Мултона 1-го порядка

// Определение уравнения 8y'''(t) + 28y''(t) + 3.5y'(t) + y(t) = 10
function dy = f(t, y)
    dy(1) = y(2);
    dy(2) = y(3);
    dy(3) = (10 - 3.5*y(2) - 28*y(1) - y(3)) / 8;
endfunction

// Параметры задачи
t0 = 0; 
t_end = 100; 
y0 = [0; 0; 0]; // Начальные условия: y(0) = 0, y'(0) = 0, y''(0) = 0
h = 0.1; // Шаг (можно изменить в программе)

// Число шагов
N = int((t_end - t0) / h);

// Создание массивов для хранения значений
T = linspace(t0, t_end, N + 1);
Y = zeros(3, N + 1);
Y(:, 1) = y0;

// Метод Адамса-Мултона 1-го порядка
for n = 1:N
    t_n = T(n);
    y_n = Y(:, n);
    
    // Начальное приближение для y(n+1)
    y_next = y_n + h * f(t_n, y_n);
    
    // Итерационное уточнение
    for k = 1:5
        y_next = y_n + h * f(T(n+1), y_next);
    end
    
    Y(:, n+1) = y_next;
end

// Сохранение результатов в CSV
csvWrite([T' Y(1, :)'], "output.csv");

// Выход без GUI
exit;
