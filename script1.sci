// Решение ОДУ методом Адамса-Мултона 1-го порядка в Scilab

// Определение функции правой части системы уравнений
defunction dxdt = f(t, x)
    dxdt = zeros(3, 1);
    dxdt(1) = x(2);
    dxdt(2) = x(3);
    dxdt(3) = (10 - 28*x(3) - 3.5*x(2) - x(1)) / 8;
endfunction

// Метод Адамса-Мултона первого порядка (неявный метод)
defunction [T, X] = adams_moulton1(f, t0, t_end, x0, h)
    // Количество шагов
    N = int((t_end - t0) / h);
    
    // Создание массивов для хранения значений
    T = linspace(t0, t_end, N + 1);
    X = zeros(3, N + 1);
    X(:, 1) = x0;
    
    // Итерационный метод (неявная схема)
    for n = 1:N
        t_n = T(n);
        x_n = X(:, n);
        
        // Начальное приближение
        x_next = x_n + h * f(t_n, x_n);
        
        // Итерации уточнения
        for k = 1:5
            x_next = x_n + h * f(T(n+1), x_next);
        end
        
        X(:, n+1) = x_next;
    end
endfunction

// Заданные параметры

t0 = 0; // Начальное время
t_end = 100; // Конечное время
h = 0.01; // Шаг
x0 = [0; 0; 0]; // Начальные условия y(0) = 0, y'(0) = 0, y''(0) = 0

// Запуск метода
[T, X] = adams_moulton1(f, t0, t_end, x0, h);

// Построение графика
plot(T, X(1, :), "b-");
xlabel("t");
ylabel("y(t)");
title("Решение ОДУ методом Адамса-Мултона 1-го порядка");
xgrid();
